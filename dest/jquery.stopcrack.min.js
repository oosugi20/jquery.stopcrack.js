/*! jquery.stopcrack.js (git@github.com:oosugi20/jquery.stopcrack.js.git)
* フロートした要素を隙間なく並べる
 * lastupdate: 2013-10-11
 * version: 0.1.1
 * author: Makoto OOSUGI <oosugi20@gmail.com>
 * License: MIT
 */
!function(a,b){"use script";var c,d="Stopcrack",e="stopcrack";c=function(b,c){this.el=b,this.$el=a(b),this.options=a.extend({listSelector:".stopcrack-list",itemSelector:".stopcrack-item",colClassName:"stopcrack-col"},c)},function(c){c.init=function(){this._prepareElms(),this._eventify(),this.refresh()},c._prepareElms=function(){var a=this.options.listSelector,b=this.options.itemSelector;return this.$list=this.$el.find(a),this.$item=this.$el.find(b),this},c._renderCols=function(){var b,c=this.options.colClassName;for(b=0;b<this.colLength;b+=1)this.cols[b]=a('<div class="'+c+'">'),this.cols[b].append(this.$list.clone().html("")),this.$el.append(this.cols[b]);return this},c._minCol=function(){var a,b=this.cols[0],c=b.height(),d=null;for(a=1;a<this.colLength;a+=1)d=this.cols[a].height(),c>d&&(c=d,b=this.cols[a]);return b},c._render=function(){var b=this,c=this.options.listSelector,d=[],e=[];this.$item.each(function(){var b=a(this),c=b.attr("data-stopcrack-num");isNaN(c)||""===c?e.push(b):d[c]=b}),a(d).each(function(d){var e=(d+b.colLength)%b.colLength;b.cols[e].find(c).append(a(this).clone())}),a(e).each(function(){b._minCol().find(c).append(a(this).clone())}),this.$list.hide()},c._eventify=function(){var c=this;a(b).on("resize",function(){c.width!==c.$el.width()&&c.refresh()})},c.refresh=function(){var a="."+this.options.colClassName;this.$el.is(":visible")&&(this.$el.find(a).remove(),this.$list.show(),this.width=this.$el.width(),this.colLength=Math.floor(this.$list.width()/this.$item.outerWidth(!0)),this.cols=[],this._renderCols(),this._render(),this.$el.trigger("stopcrack:refresh"))}}(c.prototype),a.fn[e]=function(b){return this.each(function(){var d;a.data(this,e)?a.data(this,e).refresh():(d=new c(this,b),a.data(this,e,d),d.init())})},b[d]=c}(jQuery,this);